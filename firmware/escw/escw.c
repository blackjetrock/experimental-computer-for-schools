/**
 * Copyright (c) 2022 Raspberry Pi (Trading) Ltd.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 */

//
// Wifi support for the experimental schools computer added to this file.
//

#include <string.h>

#include "pico/cyw43_arch.h"
#include "pico/stdlib.h"

#include "lwip/pbuf.h"
#include "lwip/tcp.h"

#include "dhcpserver.h"
#include "dnsserver.h"

#include "../pico_main/fsms.h"
#include "../pico_main/esc_fsms.h"

#include "../pico_main/esc.h"

//E7E9EB
// orange:background-color:#FFA500 ;

#define KB_BODY "<!DOCTYPE html> \
<html>  \
<head>  \
  <meta charset=\"utf-8\"> \
  <link rel=\"stylesheet\" href=\"http://192.168.4.1/escfont\"> \
<style>  \
 tvf { \
        font-family: escfont; \
	//font-family: monospace, monospace; \
        font-size: 48px; \
      } \
\
body {			      \
  background-color:#f07351 ;  \
}  \
  \
#myDIV {  \
  height:50px;  \
  width: 50px;  \
  background-color:#1010FF;  \
  color:#FFFFFF;  \
  border: 1px solid black;  \
  border-radius:300px;  \
  padding:10px;  \
  text-align: center;  \
  line-height: 21px  \
}  \
  \
#myDIVs {  \
  height:50px;  \
  width: 50px;  \
  background-color:#1010FF;  \
  color:#FFFFFF;  \
  border: 1px solid black;  \
  border-radius:300px;  \
  padding:10px;  \
  text-align: center;  \
  line-height: 45px  \
}  \
#myDIVsb {  \
  height:50px;  \
  width: 50px;  \
  background-color:#1010FF;  \
  color:#FFFFFF;  \
  border: 1px solid black;  \
  border-radius:300px;  \
  padding:10px;  \
  text-align: center;  \
  line-height: 40px;   \
  font-size: 25px;  \
}  \
  \
#myDIV2 {  \
  height:50px;  \
  width: 50px;  \
  background-color:#1010FF;  \
  color:#FFFFFF;  \
  border: 1px solid black;  \
  border-radius:300px;  \
  padding:10px;  \
  text-align: center;  \
  offset-position: 10px;  \
  line-height: 21px  \
font-family = escfont; \
}  \
#myDIV2s {  \
  height:50px;  \
  width: 50px;  \
  background-color:#1010FF;  \
  color:#FFFFFF;  \
  border: 1px solid black;  \
  border-radius:300px;  \
  padding:10px;  \
  text-align: center;  \
  offset-position: 10px;  \
  line-height:45px;  \
}  \
#myDIV2sb {  \
  height:50px;  \
  width: 50px;  \
  background-color:#1010FF;  \
  color:#FFFFFF;  \
  border: 1px solid black;  \
  border-radius:300px;  \
  padding:10px;  \
  text-align: center;  \
  offset-position: 10px;  \
  line-height:45px;  \
  font-size:25px;  \
}  \
  \
table {  \
  border-collapse: collapse;  \
  <!-width: 100%;>  \
}  \
  \
#myTable2 {  \
  border-collapse: collapse;  \
  margin-left: 40px;  \
}  \
  \
th, td {  \
  padding: 8px;  \
  text-align: left;  \
  <!-border-bottom: 1px solid #ddd;>  \
}  \
 a:link {  \
  color: white;  \
  text-decoration: none;  \
}  \
 \
a:visited {  \
  color: white;  \
  text-decoration: none;  \
}  \
  \
</style>  \
</head>  \
  \
  \
<body>  \
  \
<h1>Experimental Schools Computer Simulation</h1>  \
 <p><pre><tvf>%s</tvf></pre></p> \
<table>  \
  <tr>  \
<th><div id=\"myDIV\"><a href=\"?key=2\">load<br>i.a.r.</a></div></th>  \
<th><div id=\"myDIV\"><a href=\"?key=3\">load<br>addr</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
  \
<th><div id=\"myDIVs\"><a href=\"?key=8\">clear</a></div></th>  \
<th><div id=\"myDIVsb\"><a href=\"?key=9\">-</a></div></th>  \
<th><div id=\"myDIVsb\"><a href=\"?key=10\">.</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIVsb\"><a href=\"?key=21\">A</a></div></th>  \
<th><div id=\"myDIVs\"><a href=\"?key=24\">run</a></div></th>  \
  \
</tr>  \
</table>  \
  \
<table id=\"myTable2\">  \
<tr>  \
<th><div id=\"myDIV2\"><a href=\"?key=4\">load<br>store</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIV2sb\"><a href=\"?key=12\">1</a></div></th>  \
<th><div id=\"myDIV2sb\"><a href=\"?key=13\">2</a></div></th>  \
<th><div id=\"myDIV2sb\"><a href=\"?key=14\">3</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
  \
<th><div id=\"myDIV2\" style=\"line-height: 35px; font-size: 25px\"><a href=\"?key=22\">B</a></div></th>  \
<th><div id=\"myDIV2\" style=\"line-height: 35px\"><a href=\"?key=25\">stop</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIV2\" style=\"line-height: 35px\"><a href=\"?key=27\">dump</a></div></th>  \
  \
</tr>  \
</table>  \
  \
<table>  \
  <tr>  \
<th><div id=\"myDIV\"><a href=\"?key=5\">decr<br>addr</a></div></th>  \
<th><div id=\"myDIV\"><a href=\"?key=6\">incr<br>addr</a></div></trh>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIVsb\"><a href=\"?key=15\">4</a></div></th>  \
<th><div id=\"myDIVsb\"><a href=\"?key=16\">5</a></div></th>  \
<th><div id=\"myDIVsb\"><a href=\"?key=17\">6</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIVsb\"><a href=\"?key=23\">C</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIVs\"><a href=\"?key=28\">check</a></div></th>  \
  \
<tr>  \
</table>  \
  \
<table id=\"myTable2\">  \
<tr>  \
<th><div id=\"myDIV2\"><a href=\"?key=7\">normal<br>reset</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIV2sb\"><a href=\"?key=18\">7</a></div></th>  \
<th><div id=\"myDIV2sb\"><a href=\"?key=19\">8</a></div></th>  \
<th><div id=\"myDIV2sb\"><a href=\"?key=20\">9</a></div></th>  \
<th><div id=\"myDIV2sb\"><a href=\"?key=11\">0</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIV2\"><a href=\"?key=26\">K I<br>reset</a></div></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th></th>  \
<th><div id=\"myDIV2s\"><a href=\"?key=29\">reload</a></div></th>  \
  \
</tr>  \
</table>  \
  \
  \
</body>  \
</html>"
  
#define TCP_PORT 80
#define DEBUG_printf printf
#define POLL_TIME_S 5
#define HTTP_GET "GET"
#define HTTP_RESPONSE_HEADERS             "HTTP/1.1 %d OK\nContent-Length: %d\nContent-Type: text/html; charset=utf-8\nConnection: close\n\n"
#define HTTP_RESPONSE_FONT_CSS_HEADERS   "HTTP/1.1 %d OK\nContent-Length: %d\nContent-Type: text/css; \nConnection: close\n\n"
#define HTTP_RESPONSE_FILE_DOWNLOAD      "HTTP/1.1 200 OK\nContent-Type: application/octet-stream\nContent-Disposition: attachment; filename=\"%s\"\nContent-Length: %d \nConnection: close\n\n"

#define LED_TEST_BODY							\
  "<html><body><h1>Experimental Schools Computer Simulation.</h1><p><pre>%s</pre></p>" \
 "<p><a href=\"?key=21\">A</a> " \
 "   <a href=\"?key=22\">B</a> " \
 "   <a href=\"?key=23\">C</a>"  \
  "  <a href=\"?key=2\"><span style=\"border: 2px solid #000; border-radius: 150px; padding: 5px;\">load<br>iar</span></a>" \
  "  <a href=\"?key=3\">LOAD ADDR</a>" \
  "  <a href=\"?key=4\">LOAD STORE</a></p>" \
  "  <p><a href=\"?key=5\">INCR ADDR</a>" \
  "  <a href=\"?key=6\">DECR ADDR</a>" \
  "  <a href=\"?key=7\">NORMAL RESET</a></p>" \
  "  <p><a href=\"?key=11\"><span style=\"border: 2px solid #000; border-radius: 150px; padding: 5px;\">0</span></a>" \
  "  <a href=\"?key=12\">1</a>" \
  "  <a href=\"?key=13\">2</a>" \
  "  <a href=\"?key=14\">3</a>" \
  "  <a href=\"?key=15\">4</a>" \
  "  <a href=\"?key=16\">5</a>" \
  "  <a href=\"?key=17\">6</a>" \
  "  <a href=\"?key=18\">7</a>" \
  "  <a href=\"?key=19\">8</a>" \
  "  <a href=\"?key=20\">9</a></p>" \
  "  <p><span style=\"width: 200px; height: 200px; border: 2px solid #000; border-radius: 150px; padding: 5px;\">Text here</span><a href=\"?key=0\">REFRESH</a>" \
 "</p>"
#define LED_TEST_BODY2 "<p>LED is %s</p><p><a href=\"?led=%d\">Turn led %s</a></p>"
#define LED_TEST_BODY3 "<p>LED is %s</p><p><a href=\"?led=%d\">Turn led %s</a></p>"
#define LED_TEST_BODY4 "<p>LED is %s</p><p><a href=\"?led=%d\">Turn led %s</a></p>"
#define END_BODY "</body></html>"
#define LED_PARAM "led=%d"
#define KEY_PARAM "key=%d"
#define LED_TEST "/ledtest"
#define FONT_TEST "/escfont"
#define FONT_FILE_TEST "/escfont/escfont.woff2"

#define LED_GPIO 0
#define HTTP_RESPONSE_REDIRECT "HTTP/1.1 302 Redirect\nLocation: http://%s" LED_TEST "\n\n"

#define EMBEDDED_FONT_URL_BODY " @font-face { \
  font-family: escfont; \
  src: url(http://192.168.4.1/escfont/escfont.woff2) format('woff2'); \
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD; \
} "



//Embedded font
uint8_t embedded_font[] = {
			   
// ASSEMBLER_EMBEDDED_CODE_START

// Embedded ROM file: ewsc57-Regular (9).otf
0x4f,0x54,0x54,0x4f,0x00,0x09,0x00,0x80,0x00,0x03,0x00,0x10,0x43,0x46,0x46,0x20,
0x9e,0x44,0xc8,0xa3,0x00,0x00,0x04,0xec,0x00,0x00,0x11,0xa4,0x4f,0x53,0x2f,0x32,
0x69,0x55,0x64,0x1b,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x60,0x63,0x6d,0x61,0x70,
0x04,0x1d,0x05,0x2b,0x00,0x00,0x03,0xd0,0x00,0x00,0x00,0xfc,0x68,0x65,0x61,0x64,
0x22,0x9e,0x86,0xe4,0x00,0x00,0x00,0x9c,0x00,0x00,0x00,0x36,0x68,0x68,0x65,0x61,
0x02,0xbe,0x01,0xac,0x00,0x00,0x00,0xd4,0x00,0x00,0x00,0x24,0x68,0x6d,0x74,0x78,
0x48,0xe1,0x00,0x00,0x00,0x00,0x16,0x90,0x00,0x00,0x00,0x6c,0x6d,0x61,0x78,0x70,
0x00,0x1b,0x50,0x00,0x00,0x00,0x00,0xf8,0x00,0x00,0x00,0x06,0x6e,0x61,0x6d,0x65,
0x30,0xbe,0x1d,0x6d,0x00,0x00,0x01,0x60,0x00,0x00,0x02,0x6d,0x70,0x6f,0x73,0x74,
0x00,0x03,0x00,0x00,0x00,0x00,0x04,0xcc,0x00,0x00,0x00,0x20,0x00,0x01,0x00,0x00,
0x00,0x01,0x00,0x00,0x91,0x39,0x60,0x8e,0x5f,0x0f,0x3c,0xf5,0x00,0x03,0x03,0xe8,
0x00,0x00,0x00,0x00,0xe1,0xb3,0x21,0xd2,0x00,0x00,0x00,0x00,0xe1,0xb3,0x21,0xd2,
0xfd,0x65,0xff,0x9e,0x02,0xbc,0x02,0xc2,0x00,0x00,0x00,0x03,0x00,0x02,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x02,0xbc,0xfe,0xd4,0x00,0x00,0x02,0xbc,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1b,0x00,0x00,0x50,0x00,0x00,0x1b,0x00,0x00,
0x00,0x03,0x02,0xbc,0x01,0xf4,0x00,0x05,0x00,0x00,0x02,0x8a,0x02,0xbb,0x00,0x00,
0x00,0x8c,0x02,0x8a,0x02,0xbb,0x00,0x00,0x01,0xdf,0x00,0x31,0x01,0x02,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x58,0x58,0x58,0x58,0x00,0x40,
0x00,0x20,0x00,0x69,0x02,0xbc,0xfe,0xd4,0x00,0x00,0x02,0xc2,0x00,0x62,0x00,0x00,
0x00,0x01,0x00,0x00,0x00,0x00,0x01,0x5e,0x02,0xc2,0x00,0x20,0x00,0x20,0x00,0x00,
0x00,0x00,0x00,0x22,0x01,0x9e,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
0x00,0x2d,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x06,0x00,0x00,0x00,0x01,
0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x07,0x00,0x12,0x00,0x01,0x00,0x00,0x00,0x00,
0x00,0x03,0x00,0x10,0x00,0x9f,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x0e,
0x00,0x27,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x05,0x00,0x0d,0x00,0x78,0x00,0x01,
0x00,0x00,0x00,0x00,0x00,0x06,0x00,0x0d,0x00,0x51,0x00,0x01,0x00,0x00,0x00,0x00,
0x00,0x07,0x00,0x01,0x00,0x2d,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x01,
0x00,0x2d,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x09,0x00,0x01,0x00,0x2d,0x00,0x01,
0x00,0x00,0x00,0x00,0x00,0x0a,0x00,0x01,0x00,0x2d,0x00,0x01,0x00,0x00,0x00,0x00,
0x00,0x0b,0x00,0x01,0x00,0x2d,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x0c,0x00,0x01,
0x00,0x2d,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x0d,0x00,0x01,0x00,0x2d,0x00,0x01,
0x00,0x00,0x00,0x00,0x00,0x0e,0x00,0x01,0x00,0x2d,0x00,0x01,0x00,0x00,0x00,0x00,
0x00,0x10,0x00,0x06,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x11,0x00,0x07,
0x00,0x12,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x00,0x00,0x02,0x00,0x41,0x00,0x03,
0x00,0x01,0x04,0x09,0x00,0x01,0x00,0x0c,0x00,0x06,0x00,0x03,0x00,0x01,0x04,0x09,
0x00,0x02,0x00,0x0e,0x00,0x19,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x03,0x00,0x20,
0x00,0xaf,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x04,0x00,0x1c,0x00,0x35,0x00,0x03,
0x00,0x01,0x04,0x09,0x00,0x05,0x00,0x1a,0x00,0x85,0x00,0x03,0x00,0x01,0x04,0x09,
0x00,0x06,0x00,0x1a,0x00,0x5e,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x07,0x00,0x02,
0x00,0x41,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x08,0x00,0x02,0x00,0x41,0x00,0x03,
0x00,0x01,0x04,0x09,0x00,0x09,0x00,0x02,0x00,0x41,0x00,0x03,0x00,0x01,0x04,0x09,
0x00,0x0a,0x00,0x02,0x00,0x41,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x0b,0x00,0x02,
0x00,0x41,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x0c,0x00,0x02,0x00,0x41,0x00,0x03,
0x00,0x01,0x04,0x09,0x00,0x0d,0x00,0x02,0x00,0x41,0x00,0x03,0x00,0x01,0x04,0x09,
0x00,0x0e,0x00,0x02,0x00,0x41,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x10,0x00,0x0c,
0x00,0x06,0x00,0x03,0x00,0x01,0x04,0x09,0x00,0x11,0x00,0x0e,0x00,0x19,0x65,0x77,
0x73,0x63,0x35,0x37,0x00,0x65,0x00,0x77,0x00,0x73,0x00,0x63,0x00,0x35,0x00,0x37,
0x52,0x65,0x67,0x75,0x6c,0x61,0x72,0x00,0x52,0x00,0x65,0x00,0x67,0x00,0x75,0x00,
0x6c,0x00,0x61,0x00,0x72,0x65,0x77,0x73,0x63,0x35,0x37,0x20,0x52,0x65,0x67,0x75,
0x6c,0x61,0x72,0x00,0x65,0x00,0x77,0x00,0x73,0x00,0x63,0x00,0x35,0x00,0x37,0x00,
0x20,0x00,0x52,0x00,0x65,0x00,0x67,0x00,0x75,0x00,0x6c,0x00,0x61,0x00,0x72,0x65,
0x77,0x73,0x63,0x35,0x37,0x52,0x65,0x67,0x75,0x6c,0x61,0x72,0x00,0x65,0x00,0x77,
0x00,0x73,0x00,0x63,0x00,0x35,0x00,0x37,0x00,0x52,0x00,0x65,0x00,0x67,0x00,0x75,
0x00,0x6c,0x00,0x61,0x00,0x72,0x56,0x65,0x72,0x73,0x69,0x6f,0x6e,0x20,0x30,0x2e,
0x30,0x30,0x31,0x00,0x56,0x00,0x65,0x00,0x72,0x00,0x73,0x00,0x69,0x00,0x6f,0x00,
0x6e,0x00,0x20,0x00,0x30,0x00,0x2e,0x00,0x30,0x00,0x30,0x00,0x31,0x20,0x3a,0x65,
0x77,0x73,0x63,0x35,0x37,0x20,0x52,0x65,0x67,0x75,0x6c,0x61,0x72,0x00,0x20,0x00,
0x3a,0x00,0x65,0x00,0x77,0x00,0x73,0x00,0x63,0x00,0x35,0x00,0x37,0x00,0x20,0x00,
0x52,0x00,0x65,0x00,0x67,0x00,0x75,0x00,0x6c,0x00,0x61,0x00,0x72,0x00,0x00,0x00,
0x00,0x00,0x00,0x01,0x00,0x03,0x00,0x01,0x00,0x00,0x00,0x0c,0x00,0x04,0x00,0xf0,
0x00,0x00,0x00,0x38,0x00,0x20,0x00,0x04,0x00,0x18,0x00,0x00,0x00,0x20,0x00,0x2e,
0x00,0x30,0x00,0x31,0x00,0x32,0x00,0x33,0x00,0x34,0x00,0x35,0x00,0x36,0x00,0x37,
0x00,0x38,0x00,0x39,0x00,0x3a,0x00,0x3f,0x00,0x41,0x00,0x42,0x00,0x43,0x00,0x44,
0x00,0x45,0x00,0x46,0x00,0x49,0x00,0x4b,0x00,0x4c,0x00,0x52,0x00,0x5f,0x00,0x69,
0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x2e,0x00,0x30,0x00,0x31,0x00,0x32,
0x00,0x33,0x00,0x34,0x00,0x35,0x00,0x36,0x00,0x37,0x00,0x38,0x00,0x39,0x00,0x3a,
0x00,0x3f,0x00,0x41,0x00,0x42,0x00,0x43,0x00,0x44,0x00,0x45,0x00,0x46,0x00,0x49,
0x00,0x4b,0x00,0x4c,0x00,0x52,0x00,0x5f,0x00,0x69,0xff,0xff,0x00,0x00,0xff,0xe1,
0xff,0xd4,0xff,0xd3,0xff,0xd3,0xff,0xd3,0xff,0xd3,0xff,0xd3,0xff,0xd3,0xff,0xd3,
0xff,0xd3,0xff,0xd3,0xff,0xd3,0xff,0xd3,0xff,0xcf,0xff,0xce,0xff,0xce,0xff,0xce,
0xff,0xce,0xff,0xce,0xff,0xce,0xff,0xcc,0xff,0xcb,0xff,0xcb,0xff,0xc6,0xff,0xba,
0xff,0xb1,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x04,0x01,
0x00,0x01,0x01,0x01,0x0e,0x65,0x77,0x73,0x63,0x35,0x37,0x52,0x65,0x67,0x75,0x6c,
0x61,0x72,0x00,0x01,0x01,0x01,0x27,0xf8,0x1b,0x00,0xf8,0x1c,0x02,0xf8,0x1d,0x03,
0xf8,0x1e,0x04,0x8b,0x29,0xf9,0x50,0xf9,0x50,0x05,0x1d,0x00,0x00,0x00,0xe2,0x0f,
0x1d,0x00,0x00,0x01,0x17,0x11,0x8b,0x1d,0x00,0x00,0x11,0xa4,0x12,0x00,0x1e,0x01,
0x01,0x0e,0x1c,0x22,0x29,0x2e,0x34,0x38,0x3b,0x3e,0x43,0x47,0x4b,0x4e,0x53,0x58,
0x5c,0x61,0x69,0x6a,0x6b,0x6c,0x6d,0x6e,0x6f,0x70,0x71,0x72,0x73,0x7d,0x7e,0x56,
0x65,0x72,0x73,0x69,0x6f,0x6e,0x20,0x30,0x2e,0x30,0x30,0x31,0x65,0x77,0x73,0x63,
0x35,0x37,0x20,0x52,0x65,0x67,0x75,0x6c,0x61,0x72,0x65,0x77,0x73,0x63,0x35,0x37,
0x52,0x65,0x67,0x75,0x6c,0x61,0x72,0x73,0x70,0x61,0x63,0x65,0x70,0x65,0x72,0x69,
0x6f,0x64,0x7a,0x65,0x72,0x6f,0x6f,0x6e,0x65,0x74,0x77,0x6f,0x74,0x68,0x72,0x65,
0x65,0x66,0x6f,0x75,0x72,0x66,0x69,0x76,0x65,0x73,0x69,0x78,0x73,0x65,0x76,0x65,
0x6e,0x65,0x69,0x67,0x68,0x74,0x6e,0x69,0x6e,0x65,0x63,0x6f,0x6c,0x6f,0x6e,0x71,
0x75,0x65,0x73,0x74,0x69,0x6f,0x6e,0x41,0x42,0x43,0x44,0x45,0x46,0x49,0x4b,0x4c,
0x52,0x75,0x6e,0x64,0x65,0x72,0x73,0x63,0x6f,0x72,0x65,0x69,0x00,0x00,0x00,0x01,
0x8b,0x01,0x8c,0x01,0x8d,0x01,0x8e,0x01,0x8f,0x01,0x90,0x01,0x91,0x01,0x92,0x01,
0x93,0x01,0x94,0x01,0x95,0x01,0x96,0x01,0x97,0x01,0x98,0x01,0x99,0x01,0x9a,0x01,
0x9b,0x01,0x9c,0x01,0x9d,0x01,0x9e,0x01,0x9f,0x01,0xa0,0x01,0xa1,0x01,0xa2,0x01,
0xa3,0x01,0xa4,0x00,0x1b,0x02,0x00,0x01,0x00,0x4c,0x00,0x4f,0x00,0x81,0x01,0x18,
0x01,0x48,0x02,0x34,0x03,0x2d,0x04,0x00,0x04,0xd8,0x05,0xb4,0x06,0x86,0x07,0x84,
0x08,0x3c,0x08,0x89,0x09,0x5c,0x0a,0x53,0x0b,0x30,0x0b,0xe4,0x0c,0x7b,0x0d,0x11,
0x0d,0x85,0x0d,0xf7,0x0f,0x04,0x0f,0x57,0x10,0x4d,0x10,0x50,0x10,0x53,0xf8,0x5d,
0x9f,0xf9,0x37,0x15,0x8b,0x8b,0x8b,0xfd,0x37,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x35,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x37,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x35,
0x8b,0x8b,0x8b,0x08,0xbb,0xfd,0x07,0x15,0x8b,0x8b,0x8b,0xf8,0xd7,0x8b,0x8b,0x08,
0x8b,0x8b,0xf7,0xd4,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xfc,0xd7,0x8b,0x8b,0x08,
0x8b,0x8b,0xfb,0xd4,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0x0e,0xf9,0x50,0x88,0xf7,
0x74,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0x8b,0xf7,0x49,0x15,0x8b,0x8b,0x8b,
0xfb,0x67,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0x5f,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xf7,0x67,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0x5f,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,
0xf7,0x2c,0xf7,0xa5,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xfb,0x90,0xfb,0x3d,
0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,0x08,0x89,
0xf8,0xe8,0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,
0x08,0x28,0x2a,0x15,0x8b,0x8b,0x8b,0xfc,0x8d,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,
0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf8,0x8d,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,
0x8b,0x08,0xf8,0x25,0x89,0x15,0x8b,0x8b,0x8b,0xfc,0x8d,0x8b,0x8b,0x08,0x8b,0x8b,
0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf8,0x8d,0x8b,0x8b,0x08,0x8b,0x8b,0x26,
0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0x50,0xf7,0x2e,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,
0x8b,0x08,0xc3,0xf8,0xb7,0x15,0x8b,0x8b,0x8b,0xfd,0x51,0x8b,0x8b,0x08,0x8b,0x8b,
0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x51,0x8b,0x8b,0x08,0x8b,0x8b,0x26,
0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0xfb,0x5f,0xf7,0x5d,0x15,0x8b,0x8b,0x8b,0xfb,
0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5d,
0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xf4,0xed,0x15,0x8b,0x8b,0x8b,
0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,
0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xea,0xf3,0x15,0x8b,0x8b,0x8b,0x29,
0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0x5f,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,
0x8b,0x08,0x8b,0x8b,0xfb,0x5f,0x8b,0x8b,0x8b,0x08,0xf7,0x5f,0xf7,0x5a,0x15,0x8b,
0x8b,0x8b,0xfb,0x5a,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,
0x8b,0xf7,0x5a,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xfb,0xc0,0xee,
0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,0x08,0x28,
0x28,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,0x8b,0x08,0xef,0xfc,
0x8a,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x23,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x23,0x8b,0x8b,0x8b,0x08,
0x0e,0xf9,0x50,0xac,0xf7,0xe5,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xfb,0x7e,
0xfb,0x1c,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xf1,
0x26,0x15,0x8b,0x8b,0x8b,0x28,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xbd,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xee,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xbd,0x8b,0x8b,0x8b,0x08,
0xf7,0xbd,0xf7,0x61,0x15,0x8b,0x8b,0x8b,0xfb,0x60,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x60,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,
0x8b,0x8b,0x08,0x8c,0xf7,0xbd,0x15,0x8b,0x8b,0x8b,0xfb,0x60,0x8b,0x8b,0x08,0x8b,
0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x60,0x8b,0x8b,0x08,0x8b,0x8b,
0x26,0x8b,0x8b,0x8b,0x08,0xfb,0xc0,0xee,0x15,0x8b,0x8b,0x8b,0x28,0x8b,0x8b,0x08,
0x8b,0x8b,0xf7,0xbe,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xee,0x8b,0x8b,0x08,0x8b,
0x8b,0xfb,0xbe,0x8b,0x8b,0x8b,0x08,0x27,0x27,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,
0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,
0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xf7,0x5f,0xfb,0x5d,0x15,0x8b,0x8b,0x8b,0x29,0x8b,
0x8b,0x08,0x8b,0x8b,0xf7,0x55,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,
0x08,0x8b,0x8b,0xfb,0x55,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0xf7,0x58,0xf7,0xbd,
0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0x26,0xf8,0x28,0x15,0x8b,0x8b,0x8b,0xfd,
0x50,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x50,
0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xf2,0xfc,0x25,0x15,0x8b,0x8b,
0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,
0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xfb,0x5f,0xf7,0xbf,0x15,0x8b,
0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xed,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,0x8b,0x08,0x2a,0x27,0x15,0x8b,0x8b,
0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,
0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0x27,0x2a,0x15,0x8b,0x8b,0x8b,
0xfb,0x5c,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,
0x5c,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,0x8b,0x08,0xf4,0x25,0x15,0x8b,0x8b,
0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0x55,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xed,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0x55,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0x95,
0xf7,0xee,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xfb,0x65,0xfb,0x27,0x15,0x8b,
0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xed,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xef,0x29,0x15,0x8b,0x8b,
0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xbf,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xed,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xbf,0x8b,0x8b,0x8b,0x08,0xf7,0xbc,0xf7,0xbf,
0x15,0x8b,0x8b,0x8b,0xfb,0xc0,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xf7,0xc0,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,0xfc,
0x23,0xf0,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x25,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x25,0x8b,0x8b,0x8b,
0x08,0x8d,0xf7,0x5d,0x15,0x8b,0x8b,0x8b,0xfb,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,
0x8b,0x8b,0x08,0xf2,0x89,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,
0x1e,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x1e,
0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0xdd,0xf8,0x3b,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,
0x8b,0x08,0xfb,0x49,0xfb,0xd6,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,
0xf7,0xbf,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,
0xbf,0x8b,0x8b,0x8b,0x08,0x23,0xf7,0xc2,0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,
0x8b,0x8b,0xf8,0x26,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,
0x8b,0xfc,0x26,0x8b,0x8b,0x8b,0x08,0xf2,0xf7,0xbc,0x15,0x8b,0x8b,0x8b,0x28,0x8b,
0x8b,0x08,0x8b,0x8b,0xf7,0xbf,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xee,0x8b,0x8b,
0x08,0x8b,0x8b,0xfb,0xbf,0x8b,0x8b,0x8b,0x08,0x26,0xfc,0x1f,0x15,0x8b,0x8b,0x8b,
0xfb,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,
0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,0x8b,0x08,0x8a,0xf7,0xc1,0x15,0x8b,
0x8b,0x8b,0xfb,0x5e,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,
0x8b,0xf7,0x5e,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,0x8b,0x08,0xf8,0x26,0xfb,
0xc1,0x15,0x8b,0x8b,0x8b,0xfb,0x5e,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xf7,0x5e,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,
0x0e,0xf9,0x50,0x53,0xf7,0x5a,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xf7,0x95,
0xf8,0x88,0x15,0x8b,0x8b,0x8b,0xfb,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,0x8b,
0x08,0xfc,0x24,0x8e,0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x23,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x23,0x8b,
0x8b,0x8b,0x08,0x88,0xfc,0x87,0x15,0x8b,0x8b,0x8b,0xfb,0x5d,0x8b,0x8b,0x08,0x8b,
0x8b,0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,
0x25,0x8b,0x8b,0x8b,0x08,0xf1,0xed,0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,
0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0x26,
0x8b,0x8b,0x8b,0x08,0xf0,0xf5,0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,
0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,
0x8b,0x8b,0x08,0xec,0xee,0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,
0x8b,0x08,0x0e,0xf9,0x50,0xa2,0xf7,0x6d,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,
0xfb,0x76,0xe1,0x15,0x8b,0x8b,0x8b,0xfb,0x5f,0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,
0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5f,0x8b,0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,
0x8b,0x08,0xf8,0x26,0x89,0x15,0x8b,0x8b,0x8b,0xfb,0x5f,0x8b,0x8b,0x08,0x8b,0x8b,
0xf1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5f,0x8b,0x8b,0x08,0x8b,0x8b,0x25,
0x8b,0x8b,0x8b,0x08,0xfc,0x22,0xf7,0xc1,0x15,0x8b,0x8b,0x8b,0xfb,0x5f,0x8b,0x8b,
0x08,0x8b,0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5f,0x8b,0x8b,0x08,
0x8b,0x8b,0x26,0x8b,0x8b,0x8b,0x08,0xf8,0x20,0x8c,0x15,0x8b,0x8b,0x8b,0xfb,0x5f,
0x8b,0x8b,0x08,0x8b,0x8b,0xf0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5f,0x8b,
0x8b,0x08,0x8b,0x8b,0x26,0x8b,0x8b,0x8b,0x08,0xfb,0xbd,0xfc,0x87,0x15,0x8b,0x8b,
0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,0x08,0x8b,0xf7,0xc2,0x15,
0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,0x8b,0x08,0x8b,
0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,0x08,0x8a,0xf7,
0xbb,0x15,0x8b,0x8b,0x8b,0x26,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xf0,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,0x08,
0x0e,0xf9,0x50,0x5a,0xf8,0x1b,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0x58,0xfb,
0xb3,0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,0x08,
0x89,0xf7,0xbf,0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,
0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,
0x8b,0x08,0x8a,0xf7,0xbe,0x15,0x8b,0x8b,0x8b,0x26,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,
0xc1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf0,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,
0x8b,0x8b,0x8b,0x08,0xf7,0xc3,0x2a,0x15,0x8b,0x8b,0x8b,0xfc,0x8d,0x8b,0x8b,0x08,
0x8b,0x8b,0xef,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf8,0x8d,0x8b,0x8b,0x08,0x8b,
0x8b,0x27,0x8b,0x8b,0x8b,0x08,0xfc,0x24,0x89,0x15,0x8b,0x8b,0x8b,0xfb,0x60,0x8b,
0x8b,0x08,0x8b,0x8b,0xf4,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x60,0x8b,0x8b,
0x08,0x8b,0x8b,0x22,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0xa0,0xf7,0x91,0x15,0x8b,
0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0x75,0xbd,0x15,0x8b,0x8b,0x8b,0x26,0x8b,0x8b,0x08,
0x8b,0x8b,0xee,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf0,0x8b,0x8b,0x08,0x8b,0x8b,
0x28,0x8b,0x8b,0x8b,0x08,0x8a,0xf7,0x5b,0x15,0x8b,0x8b,0x8b,0x26,0x8b,0x8b,0x08,
0x8b,0x8b,0xed,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf0,0x8b,0x8b,0x08,0x8b,0x8b,
0x29,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0x52,0xf7,0xf0,0x15,0x8b,0x8b,0x8b,0x8b,
0x8b,0x8b,0x08,0xc0,0xfb,0x8b,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,
0xf2,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x24,0x8b,
0x8b,0x8b,0x08,0x8b,0xf7,0x5e,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,
0xf2,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x24,0x8b,
0x8b,0x8b,0x08,0xfb,0x5e,0xf7,0xc1,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,
0x8b,0xf2,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x24,
0x8b,0x8b,0x8b,0x08,0xf0,0xf1,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,
0xf7,0xc1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,
0xc1,0x8b,0x8b,0x8b,0x08,0xf7,0x5f,0xfb,0xc4,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,
0x08,0x8b,0x8b,0xf3,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,
0x8b,0x23,0x8b,0x8b,0x8b,0x08,0xf1,0xf7,0x5c,0x15,0x8b,0x8b,0x8b,0xfb,0x5b,0x8b,
0x8b,0x08,0x8b,0x8b,0xf2,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x5b,0x8b,0x8b,
0x08,0x8b,0x8b,0x24,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0xfc,0xd6,0xf8,0x24,0x15,
0xe3,0xf7,0x64,0xfb,0x45,0xfc,0x33,0xe4,0xf7,0x63,0x08,0xf8,0x0f,0xfb,0x60,0x15,
0x8b,0x8b,0x8b,0xfb,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,0x8b,0x08,0x8b,
0x8b,0x8b,0xf7,0x5d,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,0x8a,0xeb,
0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x24,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x24,0x8b,0x8b,0x8b,0x08,0x8a,
0xf7,0x61,0x15,0x8b,0x8b,0x8b,0xfb,0x60,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x60,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,
0x08,0xf1,0xf5,0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,
0xed,0xee,0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,0xf1,
0x22,0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,0xf0,0x2c,
0x15,0x8b,0x8b,0x8b,0xfc,0x8c,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xf8,0x8c,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,0x0e,
0xf9,0x50,0x81,0x84,0x15,0xbf,0xe7,0x23,0xfb,0x4b,0xbf,0xe6,0x08,0xfb,0x51,0xf9,
0x5a,0x15,0x8b,0x8b,0x8b,0xfd,0x52,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xf9,0x52,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,
0xf1,0xfc,0xeb,0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xba,0x8b,
0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xba,0x8b,0x8b,
0x8b,0x08,0xf7,0xbc,0xf7,0x5b,0x15,0x8b,0x8b,0x8b,0xfb,0x61,0x8b,0x8b,0x08,0x8b,
0x8b,0xef,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x61,0x8b,0x8b,0x08,0x8b,0x8b,
0x27,0x8b,0x8b,0x8b,0x08,0x8b,0xf7,0xbd,0x15,0x8b,0x8b,0x8b,0xfb,0x61,0x8b,0x8b,
0x08,0x8b,0x8b,0xef,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x61,0x8b,0x8b,0x08,
0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,0xfb,0xbd,0xfb,0x5c,0x15,0x8b,0x8b,0x8b,0x2b,
0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xeb,0x8b,
0x8b,0x08,0x8b,0x8b,0xfb,0xc0,0x8b,0x8b,0x8b,0x08,0x88,0xf7,0xc1,0x15,0x8b,0x8b,
0x8b,0x2a,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc0,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xec,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc0,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0xfb,
0x29,0xf7,0xf3,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xbb,0xfb,0x8f,0x15,0x8b,
0x8b,0x8b,0x2a,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xbf,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,
0x8b,0xec,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xbf,0x8b,0x8b,0x8b,0x08,0x28,0xf8,0x8b,
0x15,0x8b,0x8b,0x8b,0xfc,0x8c,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xf8,0x8c,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,0xef,
0xec,0x15,0x8b,0x8b,0x8b,0x2a,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xbf,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xec,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xbf,0x8b,0x8b,0x8b,0x08,
0xf7,0xbf,0x27,0x15,0x8b,0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,
0x8a,0xfc,0x26,0x15,0x8b,0x8b,0x8b,0x28,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xee,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,0x8b,0x08,
0x0e,0xf9,0x50,0xb4,0xf7,0xbf,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xfb,0x85,
0xf8,0x27,0x15,0x8b,0x8b,0x8b,0xfd,0x50,0x8b,0x8b,0x08,0x8b,0x8b,0xed,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x50,0x8b,0x8b,0x08,0x8b,0x8b,0x29,0x8b,0x8b,0x8b,
0x08,0xed,0xfc,0xee,0x15,0x8b,0x8b,0x8b,0x26,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf0,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,
0x8b,0x8b,0x08,0x8d,0xf8,0xef,0x15,0x8b,0x8b,0x8b,0x25,0x8b,0x8b,0x08,0x8b,0x8b,
0xf7,0xc1,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf1,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,
0xc1,0x8b,0x8b,0x8b,0x08,0xf7,0xc1,0x26,0x15,0x8b,0x8b,0x8b,0xfc,0x8c,0x8b,0x8b,
0x08,0x8b,0x8b,0xed,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf8,0x8c,0x8b,0x8b,0x08,
0x8b,0x8b,0x29,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0x41,0xf7,0x93,0x15,0x8b,0x8b,
0x8b,0x8b,0x8b,0x8b,0x08,0xfb,0x12,0xf8,0x53,0x15,0x8b,0x8b,0x8b,0xfd,0x50,0x8b,
0x8b,0x08,0x8b,0x8b,0xed,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x50,0x8b,0x8b,
0x08,0x8b,0x8b,0x29,0x8b,0x8b,0x8b,0x08,0xef,0x8b,0x15,0x8b,0x8b,0x8b,0x27,0x8b,
0x8b,0x08,0x8b,0x8b,0xf8,0x21,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xef,0x8b,0x8b,
0x08,0x8b,0x8b,0xfc,0x21,0x8b,0x8b,0x8b,0x08,0x8b,0xfc,0xee,0x15,0x8b,0x8b,0x8b,
0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x22,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xef,
0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x22,0x8b,0x8b,0x8b,0x08,0x8a,0xf7,0xc2,0x15,0x8b,
0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc3,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,
0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc3,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,
0x24,0xf7,0xc1,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0x8e,0xf8,0x25,0x15,0x8b,
0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x21,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,
0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x21,0x8b,0x8b,0x8b,0x08,0x8d,0xfb,0xc0,
0x15,0x8b,0x8b,0x8b,0x27,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xbc,0x8b,0x8b,0x8b,0x08,
0x8b,0x8b,0x8b,0xef,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xbc,0x8b,0x8b,0x8b,0x08,0x24,
0xf7,0xc1,0x15,0x8b,0x8b,0x8b,0xfd,0x52,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x52,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,
0x08,0x0e,0xf9,0x50,0xa0,0xbc,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xfb,0x0d,
0xc1,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,0x8b,0x8b,0x8b,
0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,0x8b,0x8b,0x08,
0xec,0xf8,0x89,0x15,0x8b,0x8b,0x8b,0xfc,0x8d,0x8b,0x8b,0x08,0x8b,0x8b,0xf1,0x8b,
0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf8,0x8d,0x8b,0x8b,0x08,0x8b,0x8b,0x25,0x8b,0x8b,
0x8b,0x08,0x29,0xf1,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xf7,0xc1,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0xfb,0xc1,0x8b,
0x8b,0x8b,0x08,0x0e,0xf9,0x50,0x8b,0xf7,0x37,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,
0x08,0xfb,0x5d,0xf8,0xb3,0x15,0x8b,0x8b,0x8b,0xfd,0x59,0x8b,0x8b,0x08,0x8b,0x8b,
0xf4,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x59,0x8b,0x8b,0x08,0x8b,0x8b,0x22,
0x8b,0x8b,0x8b,0x08,0xf4,0xfb,0xc1,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,
0x8b,0xef,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x27,
0x8b,0x8b,0x8b,0x08,0xea,0x25,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,
0xef,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,
0x8b,0x8b,0x08,0xef,0x24,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xef,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,
0x8b,0x08,0xef,0x27,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,
0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,
0x08,0xfb,0x5b,0xf8,0x29,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xef,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,
0x8b,0x08,0xef,0xee,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,
0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,
0x08,0xee,0xed,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,0x08,
0x0e,0xf9,0x50,0xbc,0xf7,0x77,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,0x8b,0x08,0xfb,0x8f,
0xf8,0x6f,0x15,0x8b,0x8b,0x8b,0xfd,0x59,0x8b,0x8b,0x08,0x8b,0x8b,0xef,0x8b,0x8b,
0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x59,0x8b,0x8b,0x08,0x8b,0x8b,0x27,0x8b,0x8b,0x8b,
0x08,0xef,0xfc,0xef,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,0x8b,0xf8,0x25,
0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,0xfc,0x25,0x8b,
0x8b,0x8b,0x08,0x0e,0xf9,0x50,0xfb,0x1f,0xf7,0x93,0x15,0x8b,0x8b,0x8b,0x8b,0x8b,
0x8b,0x08,0x4e,0xf8,0x50,0x15,0x8b,0x8b,0x8b,0xfd,0x55,0x8b,0x8b,0x08,0x8b,0x8b,
0xef,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf9,0x55,0x8b,0x8b,0x08,0x8b,0x8b,0x27,
0x8b,0x8b,0x8b,0x08,0xf1,0xfb,0xbe,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,0x08,0x8b,
0x8b,0xf7,0xbf,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,0x8b,0x8b,
0xfb,0xbf,0x8b,0x8b,0x8b,0x08,0x88,0xf7,0xc2,0x15,0x8b,0x8b,0x8b,0x22,0x8b,0x8b,
0x08,0x8b,0x8b,0xf7,0xbf,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf4,0x8b,0x8b,0x08,
0x8b,0x8b,0xfb,0xbf,0x8b,0x8b,0x8b,0x08,0xf7,0xbf,0x24,0x15,0x8b,0x8b,0x8b,0xfb,
0x59,0x8b,0x8b,0x08,0x8b,0x8b,0xed,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xf7,0x59,
0x8b,0x8b,0x08,0x8b,0x8b,0x29,0x8b,0x8b,0x8b,0x08,0xfb,0x5b,0xfb,0xc5,0x15,0x8b,
0x8b,0x8b,0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xee,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,
0xed,0x8b,0x8b,0x08,0x8b,0x8b,0x28,0x8b,0x8b,0x8b,0x08,0xee,0x2e,0x15,0x8b,0x8b,
0x8b,0x28,0x8b,0x8b,0x08,0x8b,0x8b,0xed,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xee,
0x8b,0x8b,0x08,0x8b,0x8b,0x29,0x8b,0x8b,0x8b,0x08,0xf0,0x25,0x15,0x8b,0x8b,0x8b,
0x29,0x8b,0x8b,0x08,0x8b,0x8b,0xee,0x8b,0x8b,0x8b,0x08,0x8b,0x8b,0x8b,0xed,0x8b,
0x8b,0x08,0x8b,0x8b,0x28,0x8b,0x8b,0x8b,0x08,0x0e,0xf9,0x50,0x0e,0xf9,0x50,0x0e,
0x01,0xc9,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,
0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,
0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,
0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,
0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,
0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,
0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,0x02,0xbc,0x00,0x00,
// ASSEMBLER_EMBEDDED_CODE_END
};

typedef struct TCP_SERVER_T_
{
  struct tcp_pcb *server_pcb;
  bool complete;
  ip_addr_t gw;
  async_context_t *context;
} TCP_SERVER_T;

typedef struct TCP_CONNECT_STATE_T_
{
  struct tcp_pcb *pcb;
  int sent_len;
  int header_type;
  char headers[256];
  uint8_t result[10000];
  int header_len;
  int result_len;
  ip_addr_t *gw;
} TCP_CONNECT_STATE_T;

static err_t tcp_close_client_connection(TCP_CONNECT_STATE_T *con_state, struct tcp_pcb *client_pcb, err_t close_err)
{
  if (client_pcb) {
    assert(con_state && con_state->pcb == client_pcb);
    tcp_arg(client_pcb, NULL);
    tcp_poll(client_pcb, NULL, 0);
    tcp_sent(client_pcb, NULL);
    tcp_recv(client_pcb, NULL);
    tcp_err(client_pcb, NULL);
    err_t err = tcp_close(client_pcb);
    if (err != ERR_OK) {
      DEBUG_printf("close failed %d, calling abort\n", err);
      tcp_abort(client_pcb);
      close_err = ERR_ABRT;
    }
    if (con_state) {
      free(con_state);
    }
  }
  return close_err;
}

static void tcp_server_close(TCP_SERVER_T *state) {
  if (state->server_pcb) {
    tcp_arg(state->server_pcb, NULL);
    tcp_close(state->server_pcb);
    state->server_pcb = NULL;
  }
}

static err_t tcp_server_sent(void *arg, struct tcp_pcb *pcb, u16_t len) {
  TCP_CONNECT_STATE_T *con_state = (TCP_CONNECT_STATE_T*)arg;
  DEBUG_printf("tcp_server_sent %u\n", len);
  con_state->sent_len += len;
  if (con_state->sent_len >= con_state->header_len + con_state->result_len) {
    DEBUG_printf("all done\n");
    return tcp_close_client_connection(con_state, pcb, ERR_OK);
  }
  return ERR_OK;
}

char *get_new_display(void)
{
  // Spin, processing FSM until display update flag is set, then
  // get the display and return
  int i = 0;

  printf("\nTCP Wait");
  while(/*(esc_state.update_display == 0) && */(i < 20))
    {
      drive_fsms();
      update_display();
      i++;
    }

  printf("\nTCP Wait done i=%d ud=%d",i, esc_state.update_display);
  return(get_display());
}

static int test_server_content(TCP_CONNECT_STATE_T *con_state, const char *request, const char *params, char *result, size_t max_result_len)
{
  int len = 0;
  con_state->header_type = 0;
  
  if (strncmp(request, FONT_FILE_TEST, sizeof(FONT_FILE_TEST) - 1) == 0)
    {
      int font_len = sizeof(embedded_font);

      printf("\n----- Font file download font len =%d", font_len);
      
      con_state->header_type = 1;
      memcpy(result, embedded_font, font_len);
#if 0
      for(int i=0; i<font_len; i++)
	{
	  if( (i% 16) == 0 )
	    {
	      printf("\n");
	    }
	  
	  printf("%02X ", *(result+i));
	}
#endif      
      //      len = snprintf(result, max_result_len, "%s", embedded_font);
      return(font_len);
    }

  if (strncmp(request, FONT_TEST, sizeof(FONT_TEST) - 1) == 0)
    {
      con_state->header_type = 2;
      len = snprintf(result, max_result_len, EMBEDDED_FONT_URL_BODY);
      printf("\n----- Font file link request");
      printf("\n------ '%s'", result);
      return(len);
    }

  
  if (strncmp(request, LED_TEST, sizeof(LED_TEST) - 1) == 0)
    {
    // Get the state of the led
    bool value;

    cyw43_gpio_get(&cyw43_state, LED_GPIO, &value);

    int led_state = value;
    int key_state;
    
    int info_state = 0;
    
    // See if the user changed it
    if (params)
      {
	int led_param = sscanf(params, LED_PARAM, &led_state);

	if (led_param == 1)
	  {
	    if (led_state)
	      {
		// Turn led on
		cyw43_gpio_set(&cyw43_state, 0, true);
	      }
	    else
	      {
		// Turn led off
		cyw43_gpio_set(&cyw43_state, 0, false);
	      }
	  }

	int key_param = sscanf(params, KEY_PARAM, &key_state);

	// Push key into FSM
	queue_token(key_state);
      }
    
    // Generate result
    if (led_state)
      {
	len = snprintf(result, max_result_len, KB_BODY, get_new_display());
      }
    else
      {
	len = snprintf(result, max_result_len, KB_BODY, get_new_display());
      }


    //strcat(result, END_BODY);

    len = strlen(result);
    printf("\nresult len= %d\n", len);
    }
  return len;
}

err_t tcp_server_recv(void *arg, struct tcp_pcb *pcb, struct pbuf *p, err_t err)
{
  TCP_CONNECT_STATE_T *con_state = (TCP_CONNECT_STATE_T*)arg;
  if (!p)
    {
      DEBUG_printf("connection closed\n");
      return tcp_close_client_connection(con_state, pcb, ERR_OK);
    }
  
  assert(con_state && con_state->pcb == pcb);

  if (p->tot_len > 0)
    {
      DEBUG_printf("tcp_server_recv %d err %d\n", p->tot_len, err);
#if 0
      for (struct pbuf *q = p; q != NULL; q = q->next) {
	DEBUG_printf("in: %.*s\n", q->len, q->payload);
      }
#endif
      // Copy the request into the buffer
      pbuf_copy_partial(p, con_state->headers, p->tot_len > sizeof(con_state->headers) - 1 ? sizeof(con_state->headers) - 1 : p->tot_len, 0);

      printf("\n++++'%s'", con_state->headers);
      
      // Handle GET request
      if (strncmp(HTTP_GET, con_state->headers, sizeof(HTTP_GET) - 1) == 0)
	{
	  char *request = con_state->headers + sizeof(HTTP_GET); // + space
	  char *params = strchr(request, '?');
	  if (params)
	    {
	    if (*params)
	      {
	      char *space = strchr(request, ' ');
	      *params++ = 0;
	  if (space)
	    {
	      *space = 0;
	    }
	      }
	    else
	      {
		params = NULL;
	      }
	    }
	  
	  // Generate content
	  con_state->result_len = test_server_content(con_state, request, params, con_state->result, sizeof(con_state->result));
	  DEBUG_printf("Request: %s?%s\n", request, params);
	  DEBUG_printf("Result: %d\n", con_state->result_len);
	  
	  // Check we had enough buffer space
	  if (con_state->result_len > sizeof(con_state->result) - 1)
	    {
	      DEBUG_printf("Too much result data %d\n", con_state->result_len);
	      return tcp_close_client_connection(con_state, pcb, ERR_CLSD);
	    }
	  
	  // Generate web page
	  if (con_state->result_len > 0)
	    {
	      switch( con_state->header_type)
		{
		case 0:
		  {
		    con_state->header_len = snprintf(con_state->headers, sizeof(con_state->headers), HTTP_RESPONSE_HEADERS,
						     200, con_state->result_len);
		    if (con_state->header_len > sizeof(con_state->headers) - 1)
		      {
			DEBUG_printf("Too much header data %d\n", con_state->header_len);
			return tcp_close_client_connection(con_state, pcb, ERR_CLSD);
		      }
		  }
		  break;
		  
		case 2:
		  {
		    con_state->header_len = snprintf(con_state->headers, sizeof(con_state->headers), HTTP_RESPONSE_FONT_CSS_HEADERS,
						     200, con_state->result_len);
		    if (con_state->header_len > sizeof(con_state->headers) - 1)
		      {
			DEBUG_printf("Too much header data %d\n", con_state->header_len);
			return tcp_close_client_connection(con_state, pcb, ERR_CLSD);
		      }
		  }
		  break;
		  
		case 1:
		  {
		    con_state->header_len = snprintf(con_state->headers, sizeof(con_state->headers), HTTP_RESPONSE_FILE_DOWNLOAD,
						     "escfont.woff2", con_state->result_len);
		    
		    printf("\n** header (download):'%s'\n",con_state->headers);
		    
		    if (con_state->header_len > sizeof(con_state->headers) - 1)
		      {
			DEBUG_printf("Too much header data %d\n", con_state->header_len);
			return tcp_close_client_connection(con_state, pcb, ERR_CLSD);
		      }
		  }
		  break;
		  
		}
	    }
	  else
	    {
	      // Send redirect
	      con_state->header_len = snprintf(con_state->headers, sizeof(con_state->headers), HTTP_RESPONSE_REDIRECT,
					       ipaddr_ntoa(con_state->gw));
	      DEBUG_printf("Sending redirect %s", con_state->headers);
	    }
	  
	  // Send the headers to the client
	  con_state->sent_len = 0;

	  err_t err = tcp_write(pcb, con_state->headers, con_state->header_len, 0);

	  if (err != ERR_OK)
	    {
	      DEBUG_printf("failed to write header data %d\n", err);
	      return tcp_close_client_connection(con_state, pcb, err);
	    }
	  
	  // Send the body to the client
	  if (con_state->result_len)
	    {
	      err = tcp_write(pcb, con_state->result, con_state->result_len, 0);
	      if (err != ERR_OK)
		{
		  DEBUG_printf("failed to write result data %d\n", err);
		  return tcp_close_client_connection(con_state, pcb, err);
		}
	    }
	}
      tcp_recved(pcb, p->tot_len);
    }
  
  pbuf_free(p);
  return ERR_OK;
}

static err_t tcp_server_poll(void *arg, struct tcp_pcb *pcb)
{
  TCP_CONNECT_STATE_T *con_state = (TCP_CONNECT_STATE_T*)arg;
  DEBUG_printf("tcp_server_poll_fn\n");
  return tcp_close_client_connection(con_state, pcb, ERR_OK); // Just disconnect clent?
}

static void tcp_server_err(void *arg, err_t err)
{
  TCP_CONNECT_STATE_T *con_state = (TCP_CONNECT_STATE_T*)arg;
  if (err != ERR_ABRT)
    {
      DEBUG_printf("tcp_client_err_fn %d\n", err);
      tcp_close_client_connection(con_state, con_state->pcb, err);
    }
}

static err_t tcp_server_accept(void *arg, struct tcp_pcb *client_pcb, err_t err)
{
  TCP_SERVER_T *state = (TCP_SERVER_T*)arg;
  if (err != ERR_OK || client_pcb == NULL)
    {
      DEBUG_printf("failure in accept\n");
      return ERR_VAL;
    }
  DEBUG_printf("client connected\n");
  
  // Create the state for the connection
  TCP_CONNECT_STATE_T *con_state = calloc(1, sizeof(TCP_CONNECT_STATE_T));
  if (!con_state)
    {
      DEBUG_printf("failed to allocate connect state\n");
      return ERR_MEM;
    }
  
  con_state->pcb = client_pcb; // for checking
  con_state->gw = &state->gw;
  
  // setup connection to client
  tcp_arg(client_pcb, con_state);
  tcp_sent(client_pcb, tcp_server_sent);
  tcp_recv(client_pcb, tcp_server_recv);
  tcp_poll(client_pcb, tcp_server_poll, POLL_TIME_S * 2);
  tcp_err(client_pcb, tcp_server_err);

  return ERR_OK;
}

static bool tcp_server_open(void *arg, const char *ap_name)
{
  TCP_SERVER_T *state = (TCP_SERVER_T*)arg;

  DEBUG_printf("starting server on port %d\n", TCP_PORT);

  struct tcp_pcb *pcb = tcp_new_ip_type(IPADDR_TYPE_ANY);

  if (!pcb)
    {
      DEBUG_printf("failed to create pcb\n");
      return false;
    }
  
  err_t err = tcp_bind(pcb, IP_ANY_TYPE, TCP_PORT);
  if (err)
    {
      DEBUG_printf("failed to bind to port %d\n",TCP_PORT);
      return false;
    }
  
  state->server_pcb = tcp_listen_with_backlog(pcb, 1);

  if (!state->server_pcb)
    {
      DEBUG_printf("failed to listen\n");
      if (pcb)
	{
	  tcp_close(pcb);
	}
      return false;
    }
  
  tcp_arg(state->server_pcb, state);
  tcp_accept(state->server_pcb, tcp_server_accept);
  
  printf("Try connecting to '%s' (press 'd' to disable access point)\n", ap_name);
  return true;
}

// This "worker" function is called to safely perform work when instructed by key_pressed_func
void key_pressed_worker_func(async_context_t *context, async_when_pending_worker_t *worker)
{
  assert(worker->user_data);
  printf("Disabling wifi\n");
  cyw43_arch_disable_ap_mode();
  ((TCP_SERVER_T*)(worker->user_data))->complete = true;
}

static async_when_pending_worker_t key_pressed_worker =
  {
   .do_work = key_pressed_worker_func
  };

void key_pressed_func(void *param) {
  assert(param);
  int key = getchar_timeout_us(0); // get any pending key press but don't wait
  if (key == 'd' || key == 'D')
    {
      // We are probably in irq context so call wifi in a "worker"
      async_context_set_work_pending(((TCP_SERVER_T*)param)->context, &key_pressed_worker);
    }
}

int wifi_main(void)
{
  // If not commented out then GPIO0 does not work. Must be conflict with UARt somewhere
  //stdio_init_all();
  
  TCP_SERVER_T *state = calloc(1, sizeof(TCP_SERVER_T));
  if (!state)
    {
      DEBUG_printf("failed to allocate state\n");
      return 1;
    }

  if (cyw43_arch_init())
    {
      DEBUG_printf("failed to initialise\n");
      return 1;
    }
  
  // Get notified if the user presses a key
  state->context = cyw43_arch_async_context();
  key_pressed_worker.user_data = state;
  async_context_add_when_pending_worker(cyw43_arch_async_context(), &key_pressed_worker);

  stdio_set_chars_available_callback(key_pressed_func, state);

  const char *ap_name = "SchoolsComputer";
#if 1
  const char *password = "schoolscomputer";
#else
  const char *password = NULL;
#endif

  cyw43_arch_enable_ap_mode(ap_name, password, CYW43_AUTH_WPA2_AES_PSK);

  ip4_addr_t mask;
  IP4_ADDR(ip_2_ip4(&state->gw), 192, 168, 4, 1);
  IP4_ADDR(ip_2_ip4(&mask), 255, 255, 255, 0);

  // Start the dhcp server
  dhcp_server_t dhcp_server;
  dhcp_server_init(&dhcp_server, &state->gw, &mask);

  // Start the dns server
  dns_server_t dns_server;

  dns_server_init(&dns_server, &state->gw);

  if (!tcp_server_open(state, ap_name))
    {
      DEBUG_printf("failed to open server\n");
      return 1;
    }
  
  state->complete = false;
  
  while(!state->complete)
    {
      // the following #ifdef is only here so this same example can be used in multiple modes;
      // you do not need it in your code
#if PICO_CYW43_ARCH_POLL
      // if you are using pico_cyw43_arch_poll, then you must poll periodically from your
      // main loop (not from a timer interrupt) to check for Wi-Fi driver or lwIP work that needs to be done.
      cyw43_arch_poll();
      // you can poll as often as you like, however if you have nothing else to do you can
      // choose to sleep until either a specified time, or cyw43_arch_poll() has work to do:
      cyw43_arch_wait_for_work_until(make_timeout_time_ms(1000));
#else
      // if you are not using pico_cyw43_arch_poll, then Wi-FI driver and lwIP work
      // is done via interrupt in the background. This sleep is just an example of some (blocking)
      // work you might be doing.
      //sleep_ms(1000);
      kbd_scan(&esc_state);
      drive_fsms();
      serial_loop();
      update_display();
      
#endif
    }
  
  tcp_server_close(state);
  dns_server_deinit(&dns_server);
  dhcp_server_deinit(&dhcp_server);
  cyw43_arch_deinit();
  
  return 0;
}
